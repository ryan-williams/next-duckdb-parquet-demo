(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(6953)}])},6953:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSG:function(){return c},default:function(){return Home}});var r=n(5893),a=n(7294),i=n(1560);n(4763),n(1864);let u={log:()=>{}};async function browserWorkerBundle(){let e=i.sq(),t=await i.Dn(e),n=t.mainWorker;if(n){let e=await i.ez(n);return{bundle:t,worker:e}}throw Error("No mainWorker: ".concat(n))}let o=null;function getDuckDb(){return o||(o=initDuckDb()),o}async function initDuckDb(){console.time("duckdb-wasm fetch");let{worker:e,bundle:t}=await browserWorkerBundle();console.timeEnd("duckdb-wasm fetch"),console.log("bestBundle:",t),console.time("DB instantiation");let n=new i.ak(u,e);return await n.instantiate(t.mainModule,t.pthreadWorker),await n.open({path:":memory:",query:{castBigIntToDouble:!0}}),console.timeEnd("DB instantiation"),n}async function runQuery(e,t){let n=await e.connect(),r=await n.query(t),a=r.toArray();return JSON.parse(JSON.stringify(a))}async function loadParquet(e){let t=await getDuckDb();return runQuery(t,"select * from read_parquet('".concat(e,"')"))}async function parquetBuf2json(e,t){let n=await getDuckDb(),r=new Uint8Array(e);return await n.registerFileBuffer(t,r),runQuery(n,"SELECT * FROM parquet_scan('".concat(t,"')"))}var c=!0;function Home(e){let{dataArr:t,data:n}=e,i=function(e,t){let[n,r]=(0,a.useState)(null);return(0,a.useEffect)(()=>{parquetBuf2json(e,t).then(e=>r(e))},[]),n}(t,"people"),u="".concat(window.location.href).concat("people.parquet"),o=function(e){let[t,n]=(0,a.useState)(null);return(0,a.useEffect)(()=>{e&&loadParquet(e).then(e=>n(e))},[]),t}(u);return(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{children:["Parquet data loaded on server (in ",(0,r.jsx)("code",{children:"getStaticProps"}),", with ",(0,r.jsx)("code",{children:"loadParquet"}),"):"]}),(0,r.jsx)("pre",{children:JSON.stringify(n)}),(0,r.jsxs)("p",{children:["Parquet data buffer loaded on server, parsed on client (with ",(0,r.jsx)("code",{children:"useParquetBuf"}),"):"]}),(0,r.jsx)("pre",{children:JSON.stringify(i)}),o&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("p",{children:["Parquet data fetched on client, from ",(0,r.jsx)("a",{href:u,children:u})," (with ",(0,r.jsx)("code",{children:"useParquet"}),"):"]}),(0,r.jsx)("pre",{children:JSON.stringify(o)})]})]})}}},function(e){e.O(0,[774,504,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);